# 要件定義書（Web/PWA・段階実装版）

**中学生向け 歴史一問一答動画 学習サービス（スマホ特化）**

---

## 1. 目的

* 既存の「歴史一問一答動画（約100本）」を使い、
  **スマホで短時間・反復学習**できるWebサービスを提供する。
* 「連続で進む」「苦手を繰り返す」「テスト範囲を周回する」を核に、
  定期テスト／入試の暗記効率を最大化する。
* 最小機能（MVP）から実装し、動作確認しながら段階的に拡張する。

---

## 2. 対象ユーザー

* **中学1〜3年生（本人のみ）**

---

## 3. 提供形態・前提

### 3.1 提供形態

* **Webサイト（スマホ最適化）＋ PWA対応（ホーム画面追加）**

### 3.2 端末・ブラウザ

* iOS：Safari（最新〜概ね2世代）
* Android：Chrome（最新〜概ね2世代）

### 3.3 動画の扱い（要件として固定）

* 動画は「アプリ内で再生できる」こと
* **動画終了を検知できる方式**であること（自動遷移要件のため）

  * ※具体方式（YouTube埋め込み／MP4等）は実装側で決定するが、終了イベントが取れない方式は不可

---

## 4. UX方針（スマホ・お手軽最優先）

* 1タップで学習開始できる導線
* 1回3〜10分で完結
* 文字入力は極力なし（範囲指定も選択式）
* 連続学習で止まらない（スワイプ＋自動遷移）

---

## 5. 段階実装（マイルストーン）

最小→拡張の順に、必ず「動作確認できる単位」で区切る。

---

### Phase 0：コンテンツ投入の最小要件（準備）

**目的：動くものを最速で確認するためのデータ最小形**

* 動画10本程度（テスト用）
* 各動画に紐づく問題（各1問でも可）
* メタ情報：動画ID、タイトル、単元タグ（時代）だけで開始可

---

### Phase 1（MVP）：連続学習の核だけ

**目的：スマホで“次へ次へ”と学べる最小体験を成立させる**

#### 5.1 機能要件（Phase 1）

1. **ホーム**

* ボタンは2つだけ

  * 「連続学習をはじめる」
  * 「設定」

2. **連続学習プレイヤー（単一ルート）**

* 動画 →（終了検知）→ 問題 → 次の動画 … を繰り返す
* 操作

  * 左スワイプ：次へ
  * 右スワイプ：前へ（直前のみ）
* 自動遷移（初期値ON）

  * 動画終了→問題
  * 問題完了→次動画

3. **問題UI（最小）**

* 「答えを見る」→「正解 / 不正解」2択
* 正誤ログを保存（端末内でOK）

4. **ユーザー設定（最小）**

* 1セットの動画本数（例：3/5/10）
* 自動遷移ON/OFF

#### 5.2 受け入れ基準（Phase 1）

* ホーム→1タップで連続学習開始
* 動画が終わると（ON時）自動で問題へ
* 問題に正誤を付けたら（ON時）次の動画へ
* スワイプでストレスなく次へ進む
* 学習中断→再開で続きから戻れる（簡易で可：最後の位置だけ）

---

### Phase 2：カスタマイズ学習（学習セット生成）

**目的：ユーザーが学習量・出題頻度を自分に合わせられる**

#### 5.3 機能要件（Phase 2）

1. **学習セットのカスタマイズ**

* 動画本数：スライダー/3択
* 「動画N本ごとに問題M問」設定
* 出題順：順番 / ランダム

2. **セット生成ロジック**

* 設定に基づき、今回のプレイリスト（動画/問題）を生成して連続再生

#### 5.4 受け入れ基準（Phase 2）

* 設定を変えると、実際の出題頻度と動画本数が変わる
* ランダムを選ぶとランダム順になる（同一セット内の重複は避ける）

---

### Phase 3：苦手だけ反復

**目的：点数に直結する“弱点潰し”を成立させる**

#### 5.5 機能要件（Phase 3）

1. **苦手判定**

* 初期：正答率が閾値未満（例：70%未満）
* または「直近で不正解がある」でも可（実装簡易優先）

2. **苦手だけモード**

* ホームに追加

  * 「苦手だけ」
* 出題は苦手問題を優先（苦手が尽きたら終了 or 通常へ切替）

3. **苦手比率（任意）**

* 苦手100% / 苦手7：通常3 など（設定で選択）

#### 5.6 受け入れ基準（Phase 3）

* 苦手だけを選ぶと苦手問題中心で出る
* 正解が続くと苦手から外れる（ルールは簡易で可）

---

### Phase 4：テスト範囲指定＋周回（固定/ランダム）

**目的：定期テスト運用を完成させる**

#### 5.7 機能要件（Phase 4）

1. **範囲指定（入力なし）**

* 学年（任意）／時代（単元）複数選択／テーマ（任意）
* 範囲プリセット保存（例：学年末テスト）

2. **範囲内周回**

* 「ひたすら繰り返す」
* 「範囲内ランダム」
* 「範囲内 苦手優先＋残りランダム」

3. **範囲内進捗**

* 完成度%（範囲内）
* 苦手残数
* 周回数

#### 5.8 受け入れ基準（Phase 4）

* 範囲指定後、その範囲内だけが提示され続ける
* ランダム／固定順が選べる
* 周回でき、達成度が更新される

---

## 6. 画面要件（最終形）

* ホーム（学習開始系ボタン）
* 連続学習プレイヤー
* 範囲指定（Phase 4）
* 設定（個人カスタマイズ）
* 進捗（簡易）

※ただし **Phase 1はホーム＋プレイヤー＋設定だけ**で開始する

---

## 7. データ要件（最小→拡張）

### 7.1 コンテンツデータ（動画・問題）

* videoId, title, tags（時代/テーマ等）
* questionId, videoId, questionText, answerText, (optional) explanation

### 7.2 学習ログ（ユーザーごと）

* questionId, result（○/×）, timestamp
* 正答率計算用の集計情報（都度計算 or キャッシュ）

### 7.3 設定データ

* videosPerSession
* rule: videoN / questionM
* orderMode（順番/ランダム/苦手優先）
* autoNext（動画→問題、問題→次動画）
* weakThreshold（苦手閾値）
* rangePresets（Phase 4）

### 7.4 保存方式（Web開始の最小）

* Phase 1〜2：端末内保存（localStorage / IndexedDB）
* Phase 3〜：必要に応じてサーバ保存に拡張可能（要件としては「将来移行できる設計」）

---

## 8. 非機能要件（Web/PWA）

* スマホで片手操作しやすいUI（タップ領域・縦レイアウト）
* ページ遷移・表示が軽い（学習が途切れない）
* PWA（ホーム画面追加・全画面表示）は可能なら対応（必須はPhase 2以降でも可）

---

## 9. 対象外（明確化）

* 志望校別最適化
* 外部連携
* サブユーザー（保護者・先生）
* 動画作成・編集
* 高度AI分析（初期は不要）

---

## 10. テスト方針（段階実装に合わせる）

* Phaseごとに「受け入れ基準」を満たすことを確認してから次へ
* 実機（iPhone/Android）で操作確認必須

  * スワイプ感度
  * 自動遷移
  * 戻る・中断復帰
